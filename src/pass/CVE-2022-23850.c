/*
CVE-ID: CVE-2022-23850
Description: xhtml_translate_entity in xhtml.c in epub2txt (aka epub2txt2) through 2.02 allows a stack-based buffer overflow via a crafted EPUB document.
*/

#include <stdint.h>
#include <string.h>
#include <stdio.h>
#include <assert.h>

struct _WString {
    uint32_t *str;
}; 
typedef struct _WString WString;

void xhtml_translate_entity (const WString *entity) {
    char out[20];
    char *in = (char*)entity->str;
    //assert(strlen(in) < 20);
    strcpy(out, in); //potential buffer overflow
}

int main() {
    WString wString;
    wString.str = (uint32_t*)"0123456789912345678912345";
    xhtml_translate_entity(&wString);
}
