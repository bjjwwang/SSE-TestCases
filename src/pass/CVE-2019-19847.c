/*
CVE-ID: CVE-2019-19847
Description: Libspiro through 20190731 has a stack-based buffer overflow in the spiro_to_bpath0() function in spiro.c. 
*/

#include <assert.h>

void spiro_to_bpath0(double *dm) {
    int index = 5;
    //assert(index < 5);
    dm[index] = 1.; //potential buffer overflow
}

void test_curve() {
    double d[5];
    d[0] = 1.; d[1] = d[1] = 0.;

    spiro_to_bpath0(d);
}

int main() {
    test_curve();
}
